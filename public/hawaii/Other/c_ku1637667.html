
<!DOCTYPE html
  SYSTEM "about:legacy-compat">
<html xmlns="http://www.w3.org/1999/xhtml" xmlns:whc="http://www.oxygenxml.com/webhelp/components" xml:lang="en-us" lang="en-us">
    <head><link rel="shortcut icon" href="../oxygen-webhelp/template/resources/images/webpagelogo.ico"><!----></link><link rel="icon" href="../oxygen-webhelp/template/resources/images/webpagelogo.ico"><!----></link><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="description" content="In rule set code, you sometimes need to identify data that recently changed. You might need to compare the most recent entity data from the database with the latest version of an entity in a locally ..." /><meta charset="UTF-8" /><meta name="copyright" content="(C) Copyright 2019" /><meta name="DC.rights.owner" content="(C) Copyright 2019" /><meta name="DC.type" content="concept" /><meta name="DC.format" content="HTML5" /><meta name="DC.identifier" content="c_ku1637667" /><meta name="DC.language" content="en-US" /><title>Determining what data changed in a bundle</title><!--  Generated with Oxygen version 21.1, build number 2019083011.  --><meta name="wh-path2root" content="../" /><link rel="preload" href="../oxygen-webhelp/template/resources/fonts/arial-webfont.woff2" as="font" /><link rel="preload" href="../oxygen-webhelp/template/resources/fonts/sourcesanspro-regular.woff2" as="font" /><link rel="preload" href="../oxygen-webhelp/template/resources/fonts/sourcesanspro-light-webfont.woff2" as="font" /><link rel="preload" href="../oxygen-webhelp/template/resources/fonts/sourcesanspro-extralight-webfont.woff2" as="font" /><link rel="preload" href="../oxygen-webhelp/template/resources/fonts/sourcesanspro-black-webfont.woff2" as="font" /><link rel="preload" href="../oxygen-webhelp/template/resources/fonts/sourcesanspro-semibold-webfont.woff2" as="font" /><link rel="preload" href="../oxygen-webhelp/template/resources/fonts/AvenirNextLTPro-Regular.woff" as="font" /><link rel="preload" href="../oxygen-webhelp/template/resources/fonts/cour.woff2" as="font" /><link rel="preload" href="../oxygen-webhelp/template/resources/js/simplebar.js" as="script" /><link rel="preload" href="../oxygen-webhelp/template/resources/css/simplebar.min.css" as="style" /><link rel="preload" href="../oxygen-webhelp/template/resources/images/dharmachakra.svg" as="image" /><link rel="preload" href="../oxygen-webhelp/template/resources/images/chevron-left.svg" as="image" /><link rel="preload" href="../oxygen-webhelp/template/resources/images/chevron-right.svg" as="image" /><link rel="preload" href="../oxygen-webhelp/template/resources/images/share-alt.svg" as="image" /><link rel="preload" href="../oxygen-webhelp/template/resources/images/print-solid.svg" as="image" /><link rel="preload" href="../oxygen-webhelp/template/resources/images/times.svg" as="image" /><link rel="preload" href="../oxygen-webhelp/template/resources/images/angle-double-left.svg" as="image" /><link rel="preload" href="../oxygen-webhelp/template/resources/images/note.svg" as="image" /><link rel="stylesheet" type="text/css" href="../oxygen-webhelp/lib/bootstrap/css/bootstrap.min.css?buildId=20191106" /><link rel="stylesheet" href="../oxygen-webhelp/lib/jquery-ui/jquery-ui.min.css?buildId=20191106" /><link rel="stylesheet" type="text/css" href="../oxygen-webhelp/app/topic-page.css?buildId=2019083011" /><script type="text/javascript" src="../oxygen-webhelp/lib/jquery/jquery-3.4.1.min.js?buildId=20191106"><!----></script><script data-main="../oxygen-webhelp/app/topic-page.js" src="../oxygen-webhelp/lib/requirejs/require.js"></script><link rel="preload" href="" as="document" /><link rel="preload" href="" as="document" /><link rel="stylesheet" type="text/css" href="../oxygen-webhelp/template/resources/css/Guidewire-whr.css?buildId=2019083011" /></head>
    
    <body id="c_ku1637667" class="wh_topic_page frmBody">
        <a href="#wh_topic_body" class="sr-only sr-only-focusable">Jump to main content</a>
        <!-- EXM-36950 - Expand the args.hdr parameter here -->
        
        
        
        <header class="navbar navbar-default wh_header navbar-fixed-top" id="affix1">
    <div class="container-fluid">
        <div class="wh_header_flex_container">
            <div class="wh_logo_and_publication_title_container">
                <div class="wh_logo_and_publication_title">
                    
                    <!--
                            This component will be generated when the next parameters are specified in the transformation scenario:
                            'webhelp.logo.image' and 'webhelp.logo.image.target.url'.
                            See: http://oxygenxml.com/doc/versions/17.1/ug-editor/#topics/dita_webhelp_output.html.
                    -->
                    <a href="../index.html" class=" wh_logo not-hidden-xs "><img src="../oxygen-webhelp/template/resources/images/Guidewire_mini_logo.jpg" alt="Hawaii Documentation Demo" /></a>
                    <div class=" wh_publication_title "><a href="../index.html"><span class="title">Hawaii Documentation Demo</span></a></div>
                    
                </div>
                
                <!-- The menu button for mobile devices is copied in the output only when the 'webhelp.show.top.menu' parameter is set to 'yes' -->
                
            </div>

            <div class="wh_top_menu_and_indexterms_link collapse navbar-collapse" id="wh_top_menu_and_indexterms_link">
                
				
                
                
            </div>
			<!-- <div class="publicationDropDown">This Publication</div> -->
			<div class=" wh_search_input "><form id="searchForm" method="get" role="search" action="../search.html"><div><input type="search" placeholder="Search " class="wh_search_textfield" id="textToSearch" name="searchQuery" aria-label="Search query" required="required" /><button type="submit" class="wh_search_button" aria-label="Search"><span>Search</span></button></div></form></div>
			<div id="userAccount">
			<span>
				<i class="fas fa-dharmachakra" id="bt_logIn"></i>
			</span>
            <!--<span id="accountInfo"></span>-->            
            <span class="dropdown" id="show_profile" style="display: none;">
                <button class="dropdown-toggle" type="button" data-toggle="dropdown">
                    <span class="fas fa-dharmachakra"></span></button>
                <ul class="dropdown-menu">
                    <li class="avatar_userName"></li>
                    <li class="divider" id="divider-admin"></li>
                    <li><a href="#" id="bt_editProfile">Edit</a></li>
                    <li><a href="#" id="bt_logOff">Logout</a></li>
                </ul>
            </span>
            
            </div>
			<!-- <div class="Login">
				<span>
				<i class="fas fa-dharmachakra" id="bt_logIn"></i>
			</span></div> -->
        </div>
    </div>
</header>
        
        <!--<whc:webhelp_search_input/>-->
        
        <div class="container-fluid">
            <div class="row navbar navbar-fixed-top" id="affix2">
                <nav class="wh_tools hidden-print">
                    <span class="openNav" type="button" aria-expanded="true"><i class="fas fa-bars"></i></span>
                    <div data-tooltip-position="bottom" class=" wh_breadcrumb "></div>
                    <div class="wh_right_tools hidden-sm hidden-xs">
                        <div class=" wh_navigation_links "><span id="topic_navigation_links_header" class="navheader"></span></div>
                        <button class="wh_hide_highlight" aria-label="Toggle search highlights" title="Toggle search highlights"></button>
                        <!--<whc:webhelp_expand_collapse_sections/>-->
                        <span class=" shareLink share "><a class="button fas fa-share-alt" data-sharer="email" data-title="" data-url="" data-subject="" data-to="" title="Share this page" aria-label="Share this page" href=""></a></span>
                        <!-- <whc:webhelp_pdf_link class="pdf"/> -->
                        <span class=" whPrintLink print "><button class="fas fa-print fa-1x" onClick="window.print()" title="Print this page" aria-label="Print this page"></button></span>
                    </div>
                </nav>
            </div>
            
            <div class="wh_content_area">
                <div class="row justify-content-lg-end">
                    
                    
                    <div id="wh_topic_body" class="col-lg-6 col-md-9 col-sm-9 col-xs-12"><!-- /*DOCS-323 WebHelp Feedback - Adjust column widths*/-->
                        <div class=" wh_topic_content body "><main role="main"><article role="article" aria-labelledby="c_ku1637667__ku1637667">

<h1 class="title topictitle1" id="c_ku1637667__ku1637667">Determining what data changed in a bundle</h1>
<div class="body conbody">
<p class="p">In rule set code, you sometimes need to identify
data that recently changed. You might need to compare the most recent
entity data from the database with the latest version of an entity in
a locally modified bundle. In the most common case, rule sets contain
conditions and rule actions that must detect which if any properties
just changed. For example, if a certain object property changed, you
might want to validate properties, recalculate related properties, log
changes, or send messages to external systems. </p>
<p class="p" id="c_ku1637667__ku1629290">To detect data changes, call the object’s <span class="keyword apiname">isFieldChanged</span>
      method. If it changed, call the entity’s <span class="keyword apiname">getOriginalValue</span> method to get the
      original value loaded from the database. You must cast the original value to the expected type
      with the syntax “<code class="ph codeph">as </code><var class="keyword varname">TYPENAME</var>”. </p>
<p class="p">Depending on the type of value stored
in that property, the <span class="keyword apiname">isFieldChanged</span>
method behaves differently. The following table describes the behavior
based on the property type.</p>
<table class="table" id="c_ku1637667__ku1613670"><colgroup><col /><col /><col /></colgroup><thead class="thead">
<tr>
<th class="entry" id="c_ku1637667__ku1613670__entry__1"><p class="p">Type of property</p></th>
<th class="entry" id="c_ku1637667__ku1613670__entry__2"><p class="p">Behavior of <code class="ph codeph">getOriginalValue</code></p></th>
<th class="entry" id="c_ku1637667__ku1613670__entry__3"><p class="p">Behavior of <code class="ph codeph">isFieldChanged</code></p></th>
</tr>
</thead><tbody class="tbody">
<tr>
<td class="entry" headers="c_ku1637667__ku1613670__entry__1 "><p class="p">Scalar value</p></td>
<td class="entry" headers="c_ku1637667__ku1613670__entry__2 "><p class="p">Returns the original
simple value, such as a <code class="ph codeph">String</code>
value like <code class="ph codeph">"John Smith"</code>,
a number like 234, or any other non-entity and non-array type.</p></td>
<td class="entry" headers="c_ku1637667__ku1613670__entry__3 "><p class="p">Returns <code class="ph codeph">true</code> if and only if the
actual property value changed to a different actual value. If the value
changed to a different value and then back to the original value, <code class="ph codeph">isFieldChanged</code> would return
<code class="ph codeph">false</code>.</p></td>
</tr>
<tr>
<td class="entry" headers="c_ku1637667__ku1613670__entry__1 "><p class="p">Entity</p></td>
<td class="entry" headers="c_ku1637667__ku1613670__entry__2 "><p class="p">Guidewire applications
represent links to entity subobjects as a foreign key called the <dfn class="term">internal ID</dfn>. This foreign key is the <var class="keyword varname">entity</var><code class="ph codeph">.Id</code> property on the destination
entity. Note that the <code class="ph codeph">Id</code>
property is different than the <code class="ph codeph">PublicID</code>
property. If you call <code class="ph codeph">getOriginalValue</code>
with a foreign key field, you get an internal ID as a <span class="keyword apiname">Key</span> object. A <span class="keyword apiname">Key</span> object encapsulates the entity
type and the unique ID value for that object.</p><p class="p">To get a reference to the entity instance with the original ID use the bundle method
                  <span class="keyword apiname">loadBean</span>. </p><p class="p">For example:</p><p class="p"><code class="ph codeph">var
k = e.getOriginalValue("Address1")</code></p><p class="p"><code class="ph codeph">var bundle = Transaction.getCurrent()</code></p><p class="p"><code class="ph codeph">var addy = bundle.loadBean(k) as Address</code></p><p class="p" id="c_ku1637667__ku1630825">Remember to call the <span class="keyword apiname">getOriginalValue</span> method on the correct entity instance.
</p></td>
<td class="entry" headers="c_ku1637667__ku1613670__entry__3 "><p class="p" id="c_ku1637667__ku1613692">Returns
<code class="ph codeph">true</code> if and only
if the foreign key <code class="ph codeph">Id</code>
value for the subobject is the same in the original entity. Remember
to call the <code class="ph codeph">isFieldChanged</code> on the correct entity instance. </p><p class="p">Keep in mind that checks for a changed entity
could return <code class="ph codeph">false</code>
even if there are changes on properties of subobjects.</p><p class="p">Be aware that the foreign key is a link to
the <code class="ph codeph">Id</code> property
of the target object. The <code class="ph codeph">PublicID</code>
property of the target object is not examined.</p></td>
</tr>
<tr>
<td class="entry" headers="c_ku1637667__ku1613670__entry__1 "><p class="p">Array</p></td>
<td class="entry" headers="c_ku1637667__ku1613670__entry__2 "><p class="p">Returns an array containing
the set of array elements that were originally persisted. </p><p class="p">If any properties changed on those elements,
the bundle contains the new values, not the original values. If you need
the original properties on those array elements, you must examine each
combination of element and properties by calling <code class="ph codeph">getOriginalValue</code> on each
array element for each property. </p></td>
<td class="entry" headers="c_ku1637667__ku1613670__entry__3 "><p class="p">Returns <code class="ph codeph">true</code> if any elements were
added or removed to the array. </p><p class="p" id="c_ku1637667__ku1647130">Additionally, if the array is defined in the
data model configuration as an owned array, if any properties on an array
element changed, <code class="ph codeph">isFieldChanged</code> returns true. This does not apply
to non-owned arrays.</p><div class="note note note_note"><span class="note__title">Note:</span> Because entity array order is not meaningful, the order is not checked by
                  <code class="ph codeph">isFieldChanged</code>. In this case, <code class="ph codeph">isFieldChanged</code>
                returns the same value as the array method
                  <span class="keyword apiname">isArrayElementAddedOrRemoved</span>.</div></td>
</tr>
</tbody></table>

<section class="section"><h2 class="title sectiontitle">Scalar value property example</h2><p class="p">For a scalar value example, the <span class="keyword apiname">Address</span> entity contains a <code class="ph codeph">String</code> value property called <code class="ph codeph">City</code>. If the <code class="ph codeph">address.City</code> value is different
from the original entity, <code class="ph codeph">address.isFieldChanged("City")</code>
returns <code class="ph codeph">true</code> and <code class="ph codeph">address.getOriginalValue("City")</code>
returns the original value for this property of type <code class="ph codeph">String</code>.</p></section>

<section class="section"><h2 class="title sectiontitle">Entity property example 1</h2><p class="p">For an entity property example, the ClaimCenter
application includes a <span class="keyword apiname">Claim</span>
entity with a <code class="ph codeph">LossLocation</code>
property containing an <span class="keyword apiname">Address</span>
entity. </p>
<p class="p">If that property points to an entirely
different entity instance than the original entity loaded from the database,
it is considered changed:</p>
<ul class="ul">
<li class="li">The expression <code class="ph codeph">claim.isFieldChanged("LossLocation")</code>
returns <code class="ph codeph">true</code> </li>
<li class="li">The expression <code class="ph codeph">claim.getOriginalValue("LossLocation")</code>
returns the ID of the original entity instance as a <code class="ph codeph">Key</code>. Do not assume that the original
entity instance is unchanged. It may be loaded and already changed. </li>
</ul>

<p class="p">For example:</p>
<pre class="pre codeblock"><code>if (claim.isFieldChanged("LossLocation")) { 
  // Get original entity
  var id = claim.getOriginalValue("LossLocation") as Key 
  var originalAddress = claim.Bundle.loadBean(id)

  // Get original property on original entity
  var origAddLine1 = originalAddress.getOriginalValue("AddressLine1")
}</code></pre>
<p class="p">In contrast, if the <code class="ph codeph">claim.isFieldChanged("LossLocation")</code>
returns <code class="ph codeph">false</code>, then the
entity foreign key is unchanged but that does not mean necessarily that
data in a subobject is unchanged. To check properties on subobjects,
you must test specific properties on the subobject using the <span class="keyword apiname">isFieldChanged</span> method. For example:</p>
<pre class="pre codeblock"><code>if (not claim.isFieldChanged("LossLocation")) {
    if (claim.LossLocation.isFieldChanged("City")) {
      var origAddLine1 = claim.LossLocation.getOriginalValue("AddressLine1")
  }
}</code></pre></section>







<section class="section"><h2 class="title sectiontitle">Entity property example 2</h2><p class="p">The following example gets the original
value for an entity property and gets a property on that original object</p>
<pre class="pre codeblock"><code>var originalPolicyID = account.getOriginalValue("Policy") as Key
var originalPolicy = account.Bundle.loadBean(originalPolicyID)
var originalPolicyNumber = originalPolicy.getOriginalValue("PolicyNumber") as String</code></pre>
<p class="p seealso">See also</p>
<ul class="ul">
<li seealso-li="yes" class="li"><a class="xref" href="c_ku1655628.html#c_ku1655628">Getting an entity instance from a public ID or a key</a></li>
</ul>
</section>




</div>
</article></main></div>
                        
                        
                        
                    </div>
                    
                        <nav role="navigation" id="wh_topic_toc" class="col-lg-2 hidden-sm hidden-xs navbar hidden-print"> <!-- /*DOCS-323 WebHelp Feedback - Adjust column widths*/-->
                            <div></div>
                        </nav>
                    
                </div>
            </div>
        </div> 
        <nav class="navbar navbar-default wh_footer navbar-bottom">
  <div class=" footer-container text-center ">
    <p><span class="footercopyright">© 2019 Guidewire Software, Inc.</span><span class="footerDate">Published November 21, 2019</span></p>
  </div>
</nav>
        
        <div id="go2top">
            <span class="glyphicon glyphicon-chevron-up"></span>
        </div>
        
        <!-- The modal container for images -->
        <div id="modal_img_large" class="modal">
            <span class="close glyphicon glyphicon-remove"></span>
            <!-- Modal Content (The Image) -->
            <img class="modal-content" id="modal-img" />
            <!-- Modal Caption (Image Text) -->
            <div id="caption"></div>
        </div>
        
        <!-- <script src="${oxygen-webhelp-assets-dir}/lib/bootstrap/js/bootstrap.min.js" type="text/javascript"></script> -->
        
    </body>
</html>
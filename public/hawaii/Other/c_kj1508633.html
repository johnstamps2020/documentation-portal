
<!DOCTYPE html
  SYSTEM "about:legacy-compat">
<html xmlns="http://www.w3.org/1999/xhtml" xmlns:whc="http://www.oxygenxml.com/webhelp/components" xml:lang="en-us" lang="en-us">
    <head><link rel="shortcut icon" href="../oxygen-webhelp/template/resources/images/webpagelogo.ico"><!----></link><link rel="icon" href="../oxygen-webhelp/template/resources/images/webpagelogo.ico"><!----></link><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="description" content="In addition to using the Java native concurrency classes, Gosu includes utility classes that provide additional concurrency functionality. The LockingLazyVar class implements what is known as a lazy ..." /><meta charset="UTF-8" /><meta name="copyright" content="(C) Copyright 2019" /><meta name="DC.rights.owner" content="(C) Copyright 2019" /><meta name="DC.type" content="concept" /><meta name="DC.format" content="HTML5" /><meta name="DC.identifier" content="c_kj1508633" /><meta name="DC.language" content="en-US" /><title>Concurrent lazy variables</title><!--  Generated with Oxygen version 21.1, build number 2019083011.  --><meta name="wh-path2root" content="../" /><link rel="preload" href="../oxygen-webhelp/template/resources/fonts/arial-webfont.woff2" as="font" /><link rel="preload" href="../oxygen-webhelp/template/resources/fonts/sourcesanspro-regular.woff2" as="font" /><link rel="preload" href="../oxygen-webhelp/template/resources/fonts/sourcesanspro-light-webfont.woff2" as="font" /><link rel="preload" href="../oxygen-webhelp/template/resources/fonts/sourcesanspro-extralight-webfont.woff2" as="font" /><link rel="preload" href="../oxygen-webhelp/template/resources/fonts/sourcesanspro-black-webfont.woff2" as="font" /><link rel="preload" href="../oxygen-webhelp/template/resources/fonts/sourcesanspro-semibold-webfont.woff2" as="font" /><link rel="preload" href="../oxygen-webhelp/template/resources/fonts/AvenirNextLTPro-Regular.woff" as="font" /><link rel="preload" href="../oxygen-webhelp/template/resources/fonts/cour.woff2" as="font" /><link rel="preload" href="../oxygen-webhelp/template/resources/js/simplebar.js" as="script" /><link rel="preload" href="../oxygen-webhelp/template/resources/css/simplebar.min.css" as="style" /><link rel="preload" href="../oxygen-webhelp/template/resources/images/dharmachakra.svg" as="image" /><link rel="preload" href="../oxygen-webhelp/template/resources/images/chevron-left.svg" as="image" /><link rel="preload" href="../oxygen-webhelp/template/resources/images/chevron-right.svg" as="image" /><link rel="preload" href="../oxygen-webhelp/template/resources/images/share-alt.svg" as="image" /><link rel="preload" href="../oxygen-webhelp/template/resources/images/print-solid.svg" as="image" /><link rel="preload" href="../oxygen-webhelp/template/resources/images/times.svg" as="image" /><link rel="preload" href="../oxygen-webhelp/template/resources/images/angle-double-left.svg" as="image" /><link rel="preload" href="../oxygen-webhelp/template/resources/images/note.svg" as="image" /><link rel="stylesheet" type="text/css" href="../oxygen-webhelp/lib/bootstrap/css/bootstrap.min.css?buildId=20191106" /><link rel="stylesheet" href="../oxygen-webhelp/lib/jquery-ui/jquery-ui.min.css?buildId=20191106" /><link rel="stylesheet" type="text/css" href="../oxygen-webhelp/app/topic-page.css?buildId=2019083011" /><script type="text/javascript" src="../oxygen-webhelp/lib/jquery/jquery-3.4.1.min.js?buildId=20191106"><!----></script><script data-main="../oxygen-webhelp/app/topic-page.js" src="../oxygen-webhelp/lib/requirejs/require.js"></script><link rel="preload" href="" as="document" /><link rel="preload" href="" as="document" /><link rel="stylesheet" type="text/css" href="../oxygen-webhelp/template/resources/css/Guidewire-whr.css?buildId=2019083011" /></head>
    
    <body id="c_kj1508633" class="wh_topic_page frmBody">
        <a href="#wh_topic_body" class="sr-only sr-only-focusable">Jump to main content</a>
        <!-- EXM-36950 - Expand the args.hdr parameter here -->
        
        
        
        <header class="navbar navbar-default wh_header navbar-fixed-top" id="affix1">
    <div class="container-fluid">
        <div class="wh_header_flex_container">
            <div class="wh_logo_and_publication_title_container">
                <div class="wh_logo_and_publication_title">
                    
                    <!--
                            This component will be generated when the next parameters are specified in the transformation scenario:
                            'webhelp.logo.image' and 'webhelp.logo.image.target.url'.
                            See: http://oxygenxml.com/doc/versions/17.1/ug-editor/#topics/dita_webhelp_output.html.
                    -->
                    <a href="../index.html" class=" wh_logo not-hidden-xs "><img src="../oxygen-webhelp/template/resources/images/Guidewire_mini_logo.jpg" alt="Hawaii Documentation Demo" /></a>
                    <div class=" wh_publication_title "><a href="../index.html"><span class="title">Hawaii Documentation Demo</span></a></div>
                    
                </div>
                
                <!-- The menu button for mobile devices is copied in the output only when the 'webhelp.show.top.menu' parameter is set to 'yes' -->
                
            </div>

            <div class="wh_top_menu_and_indexterms_link collapse navbar-collapse" id="wh_top_menu_and_indexterms_link">
                
				
                
                
            </div>
			<!-- <div class="publicationDropDown">This Publication</div> -->
			<div class=" wh_search_input "><form id="searchForm" method="get" role="search" action="../search.html"><div><input type="search" placeholder="Search " class="wh_search_textfield" id="textToSearch" name="searchQuery" aria-label="Search query" required="required" /><button type="submit" class="wh_search_button" aria-label="Search"><span>Search</span></button></div></form></div>
			<div id="userAccount">
			<span>
				<i class="fas fa-dharmachakra" id="bt_logIn"></i>
			</span>
            <!--<span id="accountInfo"></span>-->            
            <span class="dropdown" id="show_profile" style="display: none;">
                <button class="dropdown-toggle" type="button" data-toggle="dropdown">
                    <span class="fas fa-dharmachakra"></span></button>
                <ul class="dropdown-menu">
                    <li class="avatar_userName"></li>
                    <li class="divider" id="divider-admin"></li>
                    <li><a href="#" id="bt_editProfile">Edit</a></li>
                    <li><a href="#" id="bt_logOff">Logout</a></li>
                </ul>
            </span>
            
            </div>
			<!-- <div class="Login">
				<span>
				<i class="fas fa-dharmachakra" id="bt_logIn"></i>
			</span></div> -->
        </div>
    </div>
</header>
        
        <!--<whc:webhelp_search_input/>-->
        
        <div class="container-fluid">
            <div class="row navbar navbar-fixed-top" id="affix2">
                <nav class="wh_tools hidden-print">
                    <span class="openNav" type="button" aria-expanded="true"><i class="fas fa-bars"></i></span>
                    <div data-tooltip-position="bottom" class=" wh_breadcrumb "></div>
                    <div class="wh_right_tools hidden-sm hidden-xs">
                        <div class=" wh_navigation_links "><span id="topic_navigation_links_header" class="navheader"></span></div>
                        <button class="wh_hide_highlight" aria-label="Toggle search highlights" title="Toggle search highlights"></button>
                        <!--<whc:webhelp_expand_collapse_sections/>-->
                        <span class=" shareLink share "><a class="button fas fa-share-alt" data-sharer="email" data-title="" data-url="" data-subject="" data-to="" title="Share this page" aria-label="Share this page" href=""></a></span>
                        <!-- <whc:webhelp_pdf_link class="pdf"/> -->
                        <span class=" whPrintLink print "><button class="fas fa-print fa-1x" onClick="window.print()" title="Print this page" aria-label="Print this page"></button></span>
                    </div>
                </nav>
            </div>
            
            <div class="wh_content_area">
                <div class="row justify-content-lg-end">
                    
                    
                    <div id="wh_topic_body" class="col-lg-6 col-md-9 col-sm-9 col-xs-12"><!-- /*DOCS-323 WebHelp Feedback - Adjust column widths*/-->
                        <div class=" wh_topic_content body "><main role="main"><article role="article" aria-labelledby="c_kj1508633__kj1508633">

<h1 class="title topictitle1" id="c_kj1508633__kj1508633">Concurrent lazy variables</h1>
<div class="body conbody">
<p class="p" id="c_kj1508633__kj1444944">In addition to using
the Java native concurrency classes, Gosu includes utility classes that
provide additional concurrency functionality. The <span class="keyword apiname">LockingLazyVar</span> class implements
what is known as a lazy variable. Gosu constructs a <dfn class="term">lazy
variable</dfn> the first time some code uses the variable and not at
the variable declaration. Because the <span class="keyword apiname">LockingLazyVar</span>
class uses the Java concurrency libraries, access to the lazy variable
is thread-safe. The <span class="keyword apiname">LockingLazyVar</span>
class wraps the double-checked locking pattern in a type-safe holder.
</p>
        
<p class="p">In Gosu, the <span class="keyword apiname">LockingLazyVar.make(gw.util.concurrent.LockingLazyVar.LazyVarInit)</span>
method signature returns the lazy variable object. This method requires
a Gosu block that creates an object. Gosu runs this block on the first
access of the <code class="ph codeph">LockingLazyVar</code>
value. The following example demonstrates the use of this method and
clarifies the method signature: </p>
<pre class="pre codeblock"><code>var _lazy = LockingLazyVar.make( \-&gt; new ArrayList&lt;String&gt;() )</code></pre><p class="p">The example passes a block as an argument to <code class="ph codeph">LockingLazyVar.make(...)</code>. That
      block creates a new <code class="ph codeph">ArrayList</code> that is parameterized to the
        <code class="ph codeph">String</code> class. The parameter is a block that creates a new object. In this
      case, the block returns a new <code class="ph codeph">ArrayList</code> object. You can create any object. In
      your business-use code, this block might be very resource-intensive in creating or loading
      this object.</p>
<p class="p">It is best to let Gosu infer the correct
type of the block and the result of the <span class="keyword apiname">make</span> method, as shown in this
example. Using Gosu type inference simplifies your code because you do
not need to use explicit Gosu generics syntax to define the block type,
such as the following version:</p>
<pre class="pre codeblock"><code>var _lazy : LockingLazyVar&lt;List&lt;String&gt;&gt; = LockingLazyVar.make( \-&gt; new ArrayList&lt;String&gt;() )</code></pre><p class="p">To use the lazy variable,
call its <span class="keyword apiname">get</span> method:</p>
<pre class="pre codeblock"><code>var i = _lazy.get()</code></pre><p class="p">If the block has not yet run,
Gosu runs the block when you access the lazy variable. If the block has
already run, Gosu returns the cached value of the lazy variable and does
not rerun the block.</p>
<p class="p">A good approach to using a lazy variable
is to define the variable as static and then define a property accessor
function to abstract the implementation of the variable. The following
code shows an example inside a Gosu class definition:</p>
<pre class="pre codeblock"><code>class MyClass {

  // Lazy variable using a block that calls a resource-intensive operation that retuns a String
  var _lazy = LockingLazyVar.make( \-&gt; veryExpensiveMethodThatRetunsAString() )

  // Define a property get function that gets this value
  property get MyLazyString() : String {
    return _lazy.get()
  }
}</code></pre>
<p class="p">If any code accesses the property <code class="ph codeph">MyLazyString</code>, Gosu calls its property
accessor function. The property accessor always calls the <span class="keyword apiname">get</span> method on the object. Gosu
runs the very expensive method only once, the first time that code accesses
the lazy variable value. If any code accesses this property again, Gosu
uses the cached value and does not execute the block again. This behavior
is useful in cases where you want a system to start quickly and pay only
incremental costs for resource-intensive value calculations. </p>

    <section class="section"><h2 class="title sectiontitle">Optional non-locking lazy variables</h2>
      
      <p class="p">Gosu also provides a non-locking variant of <code class="ph codeph">LockingLazyVar</code> called
          <code class="ph codeph">LocklessLazyVar</code>. Use <code class="ph codeph">LocklessLazyVar</code> if you do not need
        the code to be thread-safe. Because this class does not lock, it performs faster and has
        less chance of server deadlock. However, this class is unsafe in any context that has
        potential concurrent access and thus requires thread safety.</p>
    </section>
</div>
</article></main></div>
                        
                        
                        
                    </div>
                    
                        <nav role="navigation" id="wh_topic_toc" class="col-lg-2 hidden-sm hidden-xs navbar hidden-print"> <!-- /*DOCS-323 WebHelp Feedback - Adjust column widths*/-->
                            <div></div>
                        </nav>
                    
                </div>
            </div>
        </div> 
        <nav class="navbar navbar-default wh_footer navbar-bottom">
  <div class=" footer-container text-center ">
    <p><span class="footercopyright">© 2019 Guidewire Software, Inc.</span><span class="footerDate">Published November 21, 2019</span></p>
  </div>
</nav>
        
        <div id="go2top">
            <span class="glyphicon glyphicon-chevron-up"></span>
        </div>
        
        <!-- The modal container for images -->
        <div id="modal_img_large" class="modal">
            <span class="close glyphicon glyphicon-remove"></span>
            <!-- Modal Content (The Image) -->
            <img class="modal-content" id="modal-img" />
            <!-- Modal Caption (Image Text) -->
            <div id="caption"></div>
        </div>
        
        <!-- <script src="${oxygen-webhelp-assets-dir}/lib/bootstrap/js/bootstrap.min.js" type="text/javascript"></script> -->
        
    </body>
</html>